---
{"dg-publish":true,"dg-permalink":"photo-restoration-sd","permalink":"/photo-restoration-sd/","created":"2024-04-12T14:38:02.790+07:00","updated":"2024-04-14T12:28:34.402+07:00"}
---

На эту тему конечно куча статей есть от людей сильно прошаренных именно в [[Stable diffusion/Коротко о Stable diffusion\|Stable Diffusion]]. Расскажу в общих чертах, как это несколько раз делал составитель Короедства.

Имеется фото, например такое:
![iWZPXeojebE.jpg](/img/user/assets/iWZPXeojebE.jpg)

Суём в фотошоп, чистим крупными мазками, крупные царапины там, вмятины, убираем основные артефакты, убираем фон. Получается что-то такое:
![iWZPXeojebE.png](/img/user/assets/iWZPXeojebE.png)

В Stable Diffusion делаем две вещи: сначала CodeFormer'ом, на вкладке `Extras` который, восстанавливаем фото - восстановятся при этом в основном лица, но нам это и надо:
![02069.png](/img/user/assets/02069.png)
(не пойму только, откуда вылезла рамка)

Потом с восстановленного перегенерируем на вкладке `img2img`, чтобы примерно похоже было - лица непохожие будут:
![tmp3wnhimyn.png](/img/user/assets/tmp3wnhimyn.png)

Конечно тут надо много заходов сделать, подобрать `Denoising strength`. Здесь было 0,25.

Потом идём в фотошоп, накладываем нагенерённое на то, что из-под кодформера, и прорезаем в нагенерённом дырки под лица. Конечно я не очень аккуратно сделал, но направление такое:
![tmp3wnhimyn 1.png](/img/user/assets/tmp3wnhimyn%201.png)